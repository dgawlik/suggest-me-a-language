<!DOCTYPE html>
<html data-theme="light">
<head>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
</head>
<body>
    <main class="container" x-data="{ showBrowse: false }">
        <h1 style="font-family: 'Lobster'; font-size: 56px;"> Suggest me <br> a language</h1>

        <div style="display:inline-block; width:200px;">
            <details role="list">
                <summary aria-haspopup="listbox" role="button">
                    I ...
                </summary>
                <ul role="listbox">
                    <li x-on:click="showBrowse = true"><a>want to browse</a></li>
                    <li x-on:click="showBrowse = false"><a>know the criteria</a></li>
                    <li x-on:click="showBrowse = false"><a>need guidance</a></li>
                </ul>
            </details>
        </div>

        <div id="browse" x-show="showBrowse">
            <ul x-data="languages">
                <template x-for="language in data" :key="language.name">
                    <article x-data="{showCard: false}">
                        <h2 x-on:click="showCard = ! showCard" x-text="language.name"></h2>
                        <div x-show="showCard">
                            <p x-text="language.description"></p>
                            <ul>
                                <template x-for="feature in language.features" >
                                    <template x-if="feature.value > 0">
                                        <li x-text="featureDescription(feature)"></li>
                                    </template>
                                </template>
                            </ul>
                        </div>
                    </article>
                </template>
            </ul>
        </div>




    </main>

    <script type="application/javascript">
        const languages = {
            data: [],

            init() {
                this.get()
            },

            async get() {
                let r = await fetch('/languages')
                r = await r.json()

                this.data = r
            }
        };

        const featureDescription = (feature) => {
            if (feature.feature.fieldType.min) {
                return `${feature.feature.description} [${feature.feature.fieldType.min}/${feature.feature.fieldType.max}] = ${feature.value}`
            }
            else {
                return feature.feature.description
            }
        }

    </script>
</body>
</html>